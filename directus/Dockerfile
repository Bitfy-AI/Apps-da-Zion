FROM directus/directus:latest

USER root

# Copia seu schema
COPY ./schema.json /directus/schema.json

# Cria um arquivo de script mais legÃ­vel
RUN cat > /init.sh << 'EOF'
#!/bin/sh
echo "ðŸš€ Iniciando Directus..."
npx directus bootstrap
echo "ðŸ“‹ Aplicando schema..."
npx directus schema apply --yes /directus/schema.json || true
echo "âœ… Iniciando servidor..."
npx directus start
EOF

# Torna o script executÃ¡vel
RUN chmod +x /init.sh

USER node

# Quando o container iniciar, execute nosso script
ENTRYPOINT ["/init.sh"]
